---
title: "Rapport d’analyse de la répartition des activités agricoles et d’élevage - Sénégal"
author: "Kadidja GUEBEDIANG A NKEN--Isep2 "
date: "Année académique 2024/2025"
output:
  pdf_document:
    toc: true
    toc_depth: 3
    number_sections: true
    latex_engine: xelatex
  html_document: default
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```
\newpage
# **INTRODUCTION**

Ce rapport a pour objectif de visualiser la répartition spatiale des activités agricoles et d'élevage à partir des données de l'enquête EHCVM 2018 pour le Sénégal. Nous utilisons les données par ménage et par parcelle, combinées à un fond de carte administratif.


```{r libraries}
library(sf)
library(haven)
library(dplyr)
library(tidyr)
library(tmap)
library(ggplot2)
library(patchwork)
```


```{r import}
# Chemins d'accès (à adapter selon votre configuration)
data_path <- "C:/Users/LENOVO/Desktop/second semestre/ISEP2025/ISEP2025/projet_cartographie_Shiny/"

# Chargement des fichiers
s16a <- read_dta(paste0(data_path, "s16a_me_SEN2018.dta")) # Données agricoles
s16b <- read_dta(paste0(data_path, "s16b_me_SEN2018.dta")) 
s17  <- read_dta(paste0(data_path, "s17_me_SEN2018.dta"))  # Données élevage
s00  <- read_dta(paste0(data_path, "s00_me_SEN2018.dta"))  # Données géographiques


```



```{r nettoyage}
s00 <- s00 %>%
  rename(region = s00q01, departement = s00q02, milieu = s00q04) %>%
  select(grappe, menage, region, departement, milieu)

s16a <- s16a %>%
  rename(culture = s16aq08, superficie = s16aq09a)

s17 <- s17 %>%
  rename(espece = s17q02, nb_animaux = s17q05)
```


```{r aggregation}
agriculture <- s16a %>%
  group_by(grappe, menage) %>%
  summarise(nb_parcelles = n(), .groups = "drop")

elevage <- s17 %>%
  group_by(grappe, menage) %>%
  summarise(nb_animaux = sum(nb_animaux, na.rm = TRUE), .groups = "drop")

merged_data <- full_join(agriculture, elevage, by = c("grappe", "menage"))
merged_geo <- left_join(merged_data, s00, by = c("grappe", "menage"))

merged_geo <- merged_geo %>%
  mutate(nb_parcelles = replace_na(nb_parcelles, 0),
         nb_animaux = replace_na(nb_animaux, 0))
```


```{r region-summary}
region_data <- merged_geo %>%
  group_by(region) %>%
  summarise(
    total_parcelles = sum(nb_parcelles, na.rm = TRUE),
    total_animaux = sum(nb_animaux, na.rm = TRUE)
  )

region_data <- region_data %>% mutate(region = toupper(region))

correspondance <- data.frame(
  region = as.character(1:14),
  NOMREG = c("DAKAR", "ZIGUINCHOR", "DIOURBEL", "SAINT LOUIS", "TAMBACOUNDA",
             "KAOLACK", "THIES", "LOUGA", "FATICK", "KOLDA",
             "MATAM", "KAFFRINE", "KEDOUGOU", "SEDHIOU")
)

region_data <- left_join(region_data, correspondance, by = "region")
```





```{r map,include=TRUE}
#sen_map <- st_read("C:/Users/LENOVO/Desktop/second semestre/ISEP2025/ISEP2025/projet_cartographie_Shiny/Limite_Région.shp")
#map_data <- left_join(sen_map, region_data, by = "NOMREG")
#library(sf)
#sen_map <- suppressWarnings(
  #suppressMessages(
    #st_read("C:/Users/LENOVO/Desktop/second semestre/ISEP2025/ISEP2025/projet_cartographie_Shiny/Limite_Région.shp", quiet = TRUE)
 # )
#)

sen_map <- suppressWarnings(
  suppressMessages(
    sen_map <- st_read(paste0(data_path, "Limite_Région.shp"), quiet = TRUE)
  )
)

map_data <- left_join(sen_map, region_data, by = "NOMREG")
```

# **VISUALISATION DES ACTIVITES AGRICOLES**

 Cette section a pour objectif de représenter spatialement la répartition des activités agricoles au Sénégal. En s’appuyant sur les données issues de l’enquête EHCVM 2018, nous explorons le nombre de parcelles agricoles recensées, leur répartition par région, ainsi que le statut foncier associé à leur occupation. Cette visualisation permet d’appréhender les dynamiques régionales autour de l’accès à la terre, de mettre en évidence les contrastes territoriaux, et d’alimenter une réflexion sur l’organisation agricole à l’échelle nationale

## Cartographie des activités agricoles

La région de Kaolack est celle comptant le plus de parcelle avec 842 parcelles recensées ; elle est suivie de Kaffrine qui en compte 741. Dakar,elle, est la région comptant le moins de parcelle , n'ayant que 21 parcelles réservées pour l'agriculture alors qu'après elle , la région comptant le moins de parcelles est Matam avec 281 parcelles enregistrées, soit plus de 10 fois plus que Dakar.

```{r map-agriculture}

map_data <- map_data %>%
  mutate(label_cheptel = paste0(NOMREG, "\n", round(total_animaux, 1)))

# Carte des parcelles agricoles

tmap_mode("plot")

tm_shape(map_data) +
  tm_polygons("total_parcelles", palette = "Greens", title = "Parcelles agricoles") +
  tm_text("NOMREG", size = 0.6, col = "black", just = "left") +
  tm_text("total_parcelles", size = 0.6, col = "black", ymod = -1.0) +
  tm_title("Distribution des activités agricoles par région") +
  tm_layout(legend.outside = TRUE)
```


## Moyenne de parcelles par ménage

Dans tout le Sénégal, chaque ménage compte en moyenne 1,75 parcelles réservées à la culture, soit une parcelle et trois quarts.
Par région, on constate que les ménages comptant en moyenne le plus de parcelles réservées se situent dans la région de Kaoloack, Kaffrine et Sedhiou où chaque ménage compte en moyenne un peu plus de 2 parcelles. La région comptant le moins de parcelles par ménage est Dakar, où chaque ménage compte en moyenne un dixième de parcelles de terrain.

```{r moyenne-par-region}
mean(merged_geo$nb_parcelles, na.rm = TRUE)

moyenne_par_region <- merged_geo %>%
  group_by(region) %>%
  summarise(moyenne_parcelles = mean(nb_parcelles, na.rm = TRUE)) %>%
  mutate(region = as.character(region)) %>%
  left_join(correspondance, by = "region")

ggplot(moyenne_par_region, aes(x = reorder(NOMREG, moyenne_parcelles), y = moyenne_parcelles)) +
  geom_col(fill = "forestgreen") +
  geom_text(aes(label = round(moyenne_parcelles, 1)), vjust = -0.3, size = 3) +
  coord_flip() +
  labs(title = "Nombre moyen de parcelles par ménage",
       x = "Région", y = "Moyenne de parcelles") +
  theme_minimal()
```

## Part des parcelles en propriété par région

La plupart des ménages au Sénégal possédant des parcelles sont propriétaire de ces parcelles. 
La région possédant le moins de ménages propriétaires des parcelles dont ils ont le soin est Dakar, où la moitié des ménages possédent des parcelles dont ils ne sont pas propriétaires tandis quà Kolda, Louga ou Kedougou , 04 ménages sur 05 possèdent des parcelles dont ils sont propriétaires.

```{r part-des-parcelles-region}
# Étape 1 : Ajouter les libellés + joindre les infos régionales
occupation_data <- s16a %>%
  rename(mode_occupation = s16aq10) %>%
  left_join(s00, by = c("grappe", "menage")) %>%
  filter(!is.na(mode_occupation)) %>%
  mutate(
    region = as.character(region),
    mode_occupation = recode(as.character(mode_occupation), 
                             "1" = "Propriétaire",
                             "2" = "Prêt gratuit",
                             "3" = "Fermage",
                             "4" = "Métayage",
                             "5" = "Gage",
                             "6" = "Autre")
  )

# Étape 2 : Compter le total de parcelles et celles en propriété
occupation_pourcentage <- occupation_data %>%
  group_by(region, mode_occupation) %>%
  summarise(nb = n(), .groups = "drop") %>%
  group_by(region) %>%
  mutate(total_region = sum(nb)) %>%
  filter(mode_occupation == "Propriétaire") %>%
  mutate(pourcentage = round((nb / total_region) * 100, 1)) %>%
  left_join(correspondance, by = "region")


ggplot(occupation_pourcentage, aes(x = reorder(NOMREG, pourcentage), y = pourcentage)) +
  geom_col(fill = "darkgreen") +
  geom_text(aes(label = paste0(pourcentage, "%")), hjust = -0.1, size = 3) +
  coord_flip() +
  labs(title = "Part des parcelles en propriété par région",
       x = "Région", y = "Pourcentage") +
  theme_minimal()


```


# **VISUALISATION DES ACTIVITES PASTORALES**

Cette section s'intéresse à la représentation géographique des activités d’élevage à travers les régions du Sénégal. À partir des données collectées auprès des ménages, nous analysons la distribution du cheptel, la taille moyenne des troupeaux ainsi que le lien de propriété entre les ménages et les animaux qu’ils détiennent. L’objectif est de mettre en lumière les disparités régionales et les caractéristiques structurelles de l’élevage, élément essentiel de l’économie rurale et du mode de vie de nombreuses familles au Sénégal.

## Cartographie du cheptel

La région de Louga est celle qui compte le plus grand cheptel avec 12786 animaux, suivi de Saint-Louis avec 11343 animaux, soit environ 5 fois moins que Ziguinchor qui en compte 2726 animaux .

```{r map-cheptel}
tm_shape(map_data) +
  tm_polygons("total_animaux", palette = "Blues", title = "Cheptel") +
  tm_text("label_cheptel", size = 0.6, col = "black") +
  tm_title("Distribution du cheptel par région") +
  tm_layout(legend.outside = TRUE)
```


## Moyenne de cheptel par ménage

La région de Louga, région comptant le plus d'animaux au Sénégal, compte également en moyenne la plus grande taille de cheptel par ménage avec 35 animaux en moyenne par ménage, suivi de Dakar avec 30 animaux en moyenne par ménage; trois fois plus que Ziguinchor où les ménages n'en comptent que 10 en moyenne.
```{r moyenne-cheptel}
mean(merged_geo$nb_animaux, na.rm = TRUE)

moyenne_cheptel_region <- merged_geo %>%
  group_by(region) %>%
  summarise(moyenne_cheptel = mean(nb_animaux, na.rm = TRUE)) %>%
  mutate(region = as.character(region)) %>%
  left_join(correspondance, by = "region")

ggplot(moyenne_cheptel_region, aes(x = reorder(NOMREG, moyenne_cheptel), y = moyenne_cheptel)) +
  geom_col(fill = "steelblue") +
  geom_text(aes(label = round(moyenne_cheptel, 1)), vjust = -0.0, size = 3) +
  coord_flip() +
  labs(title = "Taille moyenne du cheptel par ménage",
       x = "Région", y = "Nombre moyen d’animaux") +
  theme_minimal()
```

## Menage éleveur par région

La grande majorité des ménages au Sénégal possédaient au moins un animal qui leur étaient propre au moment de l'enquête. En effet, pour chaque région, plus de neuf ménages sur dix possédaient au moins un animal qui leur étaient propres.

```{r menage-eleveur-par-region}
  #1 Charger les données élevage + localisation
elevage_menages <- s17 %>%
  select(grappe, menage, nb_propres = s17q06) %>%  # ou renomme selon ton nom réel
  left_join(s00, by = c("grappe", "menage")) %>%
  filter(!is.na(nb_propres)) %>%
  mutate(region = as.character(region))

  #2 Tous les ménages ayant renseigné une activité d’élevage
menages_elevage <- elevage_menages %>%
  distinct(region, grappe, menage)

  #3 Ménages éleveurs : ceux ayant déclaré au moins une espèce avec animaux propres > 0
menages_eleveurs <- elevage_menages %>%
  filter(nb_propres > 0) %>%
  distinct(region, grappe, menage)

  #4 : Calcul des effectifs + pourcentage
elevage_par_region <- menages_elevage %>%
  group_by(region) %>%
  summarise(total_menages = n()) %>%
  left_join(
    menages_eleveurs %>%
      group_by(region) %>%
      summarise(nb_eleveurs = n()),
    by = "region"
  ) %>%
  mutate(
    nb_eleveurs = replace_na(nb_eleveurs, 0),
    pourcentage = round((nb_eleveurs / total_menages) * 100, 1)
  ) %>%
  left_join(correspondance, by = "region")

ggplot(elevage_par_region, aes(x = reorder(NOMREG, pourcentage), y = pourcentage)) +
  geom_col(fill = "steelblue") +
  geom_text(aes(label = paste0(pourcentage, "%")), hjust = -0.1, size = 3) +
  coord_flip() +
  labs(title = "Part des ménages éleveurs par région",
       x = "Région", y = "Pourcentage de ménages") +
  theme_minimal()

```

# **VISUALISATION DES ACTIVITES AGRICOLES ET PASTORALES PAR MILIEU (urbain / rural)**

En fonction des milieux de résidence, on constate qu'en moyenne les ménages vivant dans les milieux urbains possèdent 3 fois moins de parcelles réservées à l'agriculture que ceux des milieux ruraux , avec 0,7 parcelles , soit sept dixième de parcelle en moyenne par ménage. Aussi, les ménages des milieux urbains ont moins comparativement aux ménages du milieu rural qui en comptent 23.5 contre 15.9 pour les ménages des milieux urbains.

```{r compar-milieu}
moyennes_milieu <- merged_geo %>%
  mutate(milieu = as_factor(milieu)) %>%
  group_by(milieu) %>%
  summarise(
    moyenne_parcelles = mean(nb_parcelles, na.rm = TRUE),
    moyenne_cheptel = mean(nb_animaux, na.rm = TRUE),
    .groups = "drop"
  )

moyennes_long <- moyennes_milieu %>%
  pivot_longer(cols = c(moyenne_parcelles, moyenne_cheptel),
               names_to = "variable", values_to = "valeur")

# Graphique 1 : Moyenne de parcelles par milieu

p1 <- ggplot(moyennes_milieu, aes(x = milieu, y = moyenne_parcelles, fill = milieu)) +
  geom_col() +
  geom_text(aes(label = round(moyenne_parcelles, 1)), vjust = -0.3, size = 3) +
  labs(title = "Nombre moyen parcelles/ ménage ",
       x = "Milieu", y = "Nombre moyen") +
  theme_minimal() +
  theme(legend.position = "none")

# Graphique 2 : Moyenne de cheptel par milieu
p2 <- ggplot(moyennes_milieu, aes(x = milieu, y = moyenne_cheptel, fill = milieu)) +
  geom_col() +
  geom_text(aes(label = round(moyenne_cheptel, 1)), vjust = -0.3, size = 3) +
  labs(title = "taille moyenne Cheptel/ ménage ",
       x = "Milieu", y = "taille moyenne") +
  theme_minimal() +
  theme(legend.position = "none")

# Afficher côte à côte
p1 + p2

```

---

# **CONCLUSION**

Ce rapport a permis de décrire et de visualiser spatialement la répartition des activités agricoles et d'élevage par région, ainsi que les différences entre milieux urbains et ruraux. Les cartes et graphes offrent une synthèse visuelle des disparités régionales observées dans les données de l'EHCVM 2018.
